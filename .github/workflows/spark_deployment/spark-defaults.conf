# Catalog and Schema Settings
spark.sql.defaultCatalog                       glue
spark.sql.catalog.glue                         org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.glue.catalog-impl            org.apache.iceberg.aws.glue.GlueCatalog
spark.sql.catalog.glue.warehouse               s3a://dbt-spark-iceberg/github-integration-testing
spark.sql.catalog.glue.io-impl                 org.apache.iceberg.aws.s3.S3FileIO
spark.sql.catalog.glue.lock-impl              org.apache.iceberg.aws.glue.DynamoLockManager
spark.sql.catalog.glue.lock.table             myGlueLockTable

# Default Schema Configuration
spark.sql.catalog.glue.default-namespace      default_snowplow_manifest

# Session Extensions
spark.sql.extensions                           org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions

# General Spark Configuration
spark.master                                   local[3]
spark.driver.memory                            10g
spark.executor.memory                          3g
spark.memory.fraction                          0.85
spark.sql.adaptive.enabled                     true

# Iceberg Specific Configuration
spark.wds.iceberg.format-version              2
spark.sql.iceberg.handle-timestamp-without-timezone true
spark.sql.catalog.spark_catalog.type          hive
spark.sql.catalog.spark_catalog               org.apache.iceberg.spark.SparkSessionCatalog

# AWS Configuration
spark.hadoop.fs.s3a.impl                       org.apache.hadoop.fs.s3a.S3AFileSystem
spark.hadoop.fs.s3a.aws.credentials.provider   org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider
spark.hadoop.fs.s3a.path.style.access         true
spark.hadoop.fs.s3a.connection.ssl.enabled    true
spark.hadoop.fs.s3a.committer.name            directory
spark.hadoop.fs.s3a.committer.staging.tmp.path /tmp/spark_staging
spark.hadoop.fs.s3a.buffer.dir                /tmp/spark_local_buf
spark.hadoop.fs.s3a.bucket.all.committer.magic.enabled true

# Write and Format Configuration
spark.sql.parquet.compression.codec           zstd
# spark.sql.parquet.mergeSchema                true
spark.sql.parquet.filterPushdown             true
spark.sql.hive.metastorePartitionPruning     true
spark.sql.streaming.schemaInference          true

# Operation Settings
spark.sql.sources.partitionOverwriteMode     dynamic
spark.sql.shuffle.partitions                 6
spark.sql.broadcastTimeout                   300
spark.network.timeout                        300s

# Transaction and Consistency
spark.sql.sources.default                    iceberg
spark.sql.extensions                         org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
# spark.sql.transaction.isolation.level        SERIALIZABLE
spark.sql.hive.thriftServer.async   true
spark.sql.hive.thriftServer.maxWorkerThreads    6
spark.sql.warehouse.dir s3a://dbt-spark-iceberg/github-integration-testing
spark.sql.catalog.glue  org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.glue.catalog-impl org.apache.iceberg.aws.glue.GlueCatalog
spark.sql.catalog.glue.warehouse    s3a://dbt-spark-iceberg/github-integration-testing
spark.sql.catalog.glue.io-impl  org.apache.iceberg.aws.s3.S3FileIO
spark.sql.defaultCatalog    glue
spark.sql.catalog.glue.database dbt-spark-iceberg
spark.sql.extensions    org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
spark.sql.iceberg.handle-timestamp-without-timezone true