# Catalog and Schema Settings
spark.sql.defaultCatalog                       glue
spark.sql.catalog.glue                         org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.glue.catalog-impl            org.apache.iceberg.aws.glue.GlueCatalog
spark.sql.catalog.glue.warehouse               s3a://dbt-spark-iceberg/github-integration-testing
spark.sql.catalog.glue.io-impl                 org.apache.iceberg.aws.s3.S3FileIO

# Default Schema Configuration
spark.sql.catalog.glue.default-namespace      default_snowplow_manifest

# Critical Iceberg Settings
spark.sql.extensions                           org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
spark.sql.iceberg.handle-timestamp-without-timezone true
spark.wds.iceberg.format-version              2

# Enhanced Iceberg Write Settings
spark.sql.iceberg.write.distribution-mode     range
spark.sql.iceberg.write.accept-any-schema     true
spark.sql.iceberg.write.merge.mode            copy-on-write
spark.sql.iceberg.write.format.default        parquet
spark.sql.iceberg.write-partitioned-fanout.enabled true

# Performance Settings
spark.sql.adaptive.enabled                     true
spark.sql.adaptive.coalescePartitions.enabled  true
spark.sql.shuffle.partitions                   10
spark.sql.parquet.compression.codec            zstd

# AWS S3 Settings
spark.hadoop.fs.s3a.impl                       org.apache.hadoop.fs.s3a.S3AFileSystem
spark.hadoop.fs.s3a.aws.credentials.provider   org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider
spark.hadoop.fs.s3a.path.style.access         true
spark.hadoop.fs.s3a.connection.ssl.enabled    true

# Memory Settings
spark.driver.memory                            10g
spark.executor.memory                          3g
spark.memory.fraction                          0.85

# Default Source Settings
spark.sql.sources.default                     iceberg
spark.sql.sources.partitionOverwriteMode      dynamic