# Spark Master Configuration
spark.master                                   local[3]

# Catalog Configuration
spark.sql.defaultCatalog                       glue
spark.sql.catalog.spark_catalog                org.apache.iceberg.spark.SparkSessionCatalog
spark.sql.catalog.spark_catalog.type           hive
spark.sql.catalog.glue                         org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.glue.catalog-impl            org.apache.iceberg.aws.glue.GlueCatalog
spark.sql.catalog.glue.warehouse               s3a://dbt-spark-iceberg/github-integration-testing
spark.sql.catalog.glue.io-impl                 org.apache.iceberg.aws.s3.S3FileIO
spark.sql.catalog.glue.lock-impl              org.apache.iceberg.aws.glue.DynamoLockManager
spark.sql.catalog.glue.lock.table             myGlueLockTable

# Default Schema/Database Configuration
spark.sql.catalog.glue.default-namespace      default_snowplow_manifest
spark.sql.database.default                    default_snowplow_manifest

# Session Extensions
spark.sql.extensions                           org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions

# Iceberg Specific Configuration
spark.sql.iceberg.handle-timestamp-without-timezone true
spark.wds.iceberg.format-version              2
spark.sql.catalogImplementation               hive
spark.sql.warehouse.dir                       s3a://dbt-spark-iceberg/github-integration-testing

# AWS S3 Configuration
spark.hadoop.fs.s3a.impl                       org.apache.hadoop.fs.s3a.S3AFileSystem
spark.hadoop.fs.s3a.aws.credentials.provider   org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider
spark.hadoop.fs.s3a.endpoint                   s3.eu-west-1.amazonaws.com
spark.hadoop.fs.s3a.path.style.access         true
spark.hadoop.fs.s3a.connection.ssl.enabled    true
spark.hadoop.fs.s3a.experimental.input.fadvise random

# Memory and Resource Configuration
spark.driver.memory                            10g
spark.executor.memory                          3g
spark.memory.fraction                          0.85
spark.memory.storageFraction                   0.3
spark.driver.maxResultSize                     2g
spark.sql.shuffle.partitions                   6
spark.default.parallelism                      6

# Performance Optimization
spark.sql.adaptive.enabled                     true
spark.sql.adaptive.coalescePartitions.enabled  true
spark.sql.adaptive.skewJoin.enabled           true
spark.sql.adaptive.localShuffleReader.enabled  true
spark.serializer                              org.apache.spark.serializer.KryoSerializer

# Transaction Management
spark.sql.sources.partitionOverwriteMode      dynamic
spark.sql.iceberg.handle-timestamp-without-timezone true